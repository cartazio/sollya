/* Tests for function annotation */

f = exp(x);
procedure EXP(X,n,p) {
          var res, oldPrec;
          oldPrec = prec;
          prec = p!;
          
	  "Using procedure function exponential";

          res = exp(X);
          
          prec = oldPrec!;
          return res;
     };
g = function(EXP);

h = annotatefunction(f,g,[-5;5],[0]);

"h = ", h, ", h(3) = ";
h(3);

"h = ", h, ", h(3) = ";
h(3);

"h = ", h, ", h(2) = ";
h(2);

"h = ", h, ", h(6) = ";
h(6);

"f = ", f, ", f(3) = ";
f(3);

"f = ", f, ", f(3) = ";
f(3);

"f = ", f, ", f(2) = ";
f(2);

"f = ", f, ", f(6) = ";
f(6);


hp = annotatefunction(diff(f),g,[-5;5],[0]);

t = diff(f);

"t = ", t, ", t(3) = ";
t(3);

"t = ", t, ", t(2) = ";
t(2);

"hp = ", hp, ", hp(2) = ";
hp(2);

"hp = ", hp, ", hp(3) = ";
hp(3);


match sin(diff(f)) with 
      sin(q) : { 
      	       	 "q = ", q, ", q(4) = ";
      	       	 q(4); 
	       }
      default : {};


restart;

procedure EXP(X,n,p) {
          var res, oldPrec;
          oldPrec = prec;
          prec = p!;
          
	  "Using procedure function exponential";

          res = exp(X);
          
          prec = oldPrec!;
          return res;
     };
g = function(EXP);

p = 46768052394588893382516870161332864698044514954899b-165 + x * (23384026197294446691258465802074096632225783601255b-164 + x * (5846006549323611672948426613035653821819225877423b-163 + x * (3897337699549074448627696490806815137319821946501b-164 + x * (7794675399098148717422744621371434831048848817417b-167 + x * (24942961277114075921122941174178849425809856036737b-171 + x * (8314320425704876115613838900105097456456371179471b-172 + x * (19004160973039701371579356991645932289422670402995b-176 + x * (19004160972669324148912122254449912156003926801563b-179 + x * (33785175062542597526738679493857229456702396042255b-183 + x * (6757035113643674378393625988264926886191860669891b-184 + x * (9828414707511252769908089206114262766633532289937b-188 + x * (26208861108003813314724515233584738706961162212965b-193 + x * (32257064253325954315953742396999456577223350602741b-197 + x * (578429089657689569703509185903214676926704485495b-195 + x * 2467888542176675658523627105540996778984959471957b-201))))))))))))));

h = annotatefunction(g, p, [-1/2;1/2], [-475294848522543b-124;475294848522543b-124]);
hp = annotatefunction(diff(g), p, [-1/2;1/2], [-475294848522543b-124;475294848522543b-124]);

prec = 24;

"h(0.25) = ";
h(0.25);

"h(0.75) = ";
h(0.75);

prec = 36;

"h(0.25) = ";
h(0.25);

prec = 48;

"h(0.25) = ";
h(0.25);

prec = 60;

"h(0.25) = ";
h(0.25);

prec = 72;

"h(0.25) = ";
h(0.25);

prec = 24;

"h(0) = ";
h(0);

"h(0.125) = ";
h(0.125);

"evaluate(h,[-0.25;0.25]) = ";
evaluate(h,[-0.25;0.25]);

prec = 72;

"evaluate(h,[-0.25;0.25]) = ";
evaluate(h,[-0.25;0.25]);


prec = 24;

q = sin(0.5 * h(x - 1));

"q = ";
q;

"q(1.25) = ";
q(1.25);

prec = 36;

"q(133/100) = ";
q(133/100);


prec = 165;

"q(1.25) = ";
q(1.25);


prec = 24;

qp = diff(q);

qp(1.25);




