\subsection{implementconstant}
\label{labimplementconstant}
\noindent Name: \textbf{implementconstant}\\
implements a constant in arbitrary precision\\
\noindent Usage: 
\begin{center}
\textbf{implementconstant}(\emph{expr}) : \textsf{constant} $\rightarrow$ \textsf{void}\\
\end{center}
\noindent Description: \begin{itemize}

\item The command \textbf{implementconstant} implements the constant expression \emph{expr} in 
   arbitrary precision. More precisely, it generates the source code (written
   in C, and using MPFR) of a function \texttt{mpfr\_const\_something} with the following
   signature:
   \begin{center}
   \texttt{void mpfr\_const\_something (mpfr\_ptr y, mp\_prec\_t prec)}
   \end{center}
   Let us denote by $c$ the exact mathematical value of the constant defined by
   the expression \emph{expr}. When called with arguments $y$ and prec (where the
   variable $y$ is supposed to be already initialized), the function
   \texttt{mpfr\_const\_something} sets the precision of $y$ to a suitable precision and
   stores in it an approximate value of c such that
   $$|y-c| \le c\,2^{1-\mathrm{prec}}.$$

\item If \emph{expr} refers to a constant defined with \textbf{libraryconstant}, the produced
   code uses the external code implementing this constant.

\item Currently, \textbf{implementconstant} makes the assumption that none of the
   non-trivial subexpressions of \emph{expr} evaluates to $0$. If \emph{expr} contains
   such a subexpression, the behavior of \textbf{implementconstant} is undefined.
\end{itemize}
\noindent Example 1: 
\begin{center}\begin{minipage}{15cm}\begin{Verbatim}[frame=single]
> implementconstant(exp(1)+log(2)/sqrt(1/10));
void
mpfr_const_something (mpfr_ptr y, mp_prec_t prec)
{
  /* Declarations */
  mpfr_t tmp1;
  mpfr_t tmp2;
  mpfr_t tmp3;
  mpfr_t tmp4;
  mpfr_t tmp5;
  mpfr_t tmp6;
  mpfr_t tmp7;

  /* Initializations */
  mpfr_init2 (tmp2, prec+5);
  mpfr_init2 (tmp1, prec+3);
  mpfr_init2 (tmp4, prec+8);
  mpfr_init2 (tmp3, prec+7);
  mpfr_init2 (tmp6, prec+11);
  mpfr_init2 (tmp7, prec+11);
  mpfr_init2 (tmp5, prec+11);
  mpfr_init2 (y, prec+3);

  /* Core */
  mpfr_set_prec (tmp2, prec+4);
  mpfr_set_ui (tmp2, 1, MPFR_RNDN);
  mpfr_set_prec (tmp1, prec+3);
  mpfr_exp (tmp1, tmp2, MPFR_RNDN);
  mpfr_set_prec (tmp4, prec+8);
  mpfr_set_ui (tmp4, 2, MPFR_RNDN);
  mpfr_set_prec (tmp3, prec+7);
  mpfr_log (tmp3, tmp4, MPFR_RNDN);
  mpfr_set_prec (tmp6, prec+11);
  mpfr_set_ui (tmp6, 1, MPFR_RNDN);
  mpfr_set_prec (tmp7, prec+11);
  mpfr_set_ui (tmp7, 10, MPFR_RNDN);
  mpfr_set_prec (tmp5, prec+11);
  mpfr_div (tmp5, tmp6, tmp7, MPFR_RNDN);
  mpfr_set_prec (tmp4, prec+7);
  mpfr_sqrt (tmp4, tmp5, MPFR_RNDN);
  mpfr_set_prec (tmp2, prec+5);
  mpfr_div (tmp2, tmp3, tmp4, MPFR_RNDN);
  mpfr_set_prec (y, prec+3);
  mpfr_add (y, tmp1, tmp2, MPFR_RNDN);

  /* Cleaning stuff */
  mpfr_clear(tmp1);
  mpfr_clear(tmp2);
  mpfr_clear(tmp3);
  mpfr_clear(tmp4);
  mpfr_clear(tmp5);
  mpfr_clear(tmp6);
  mpfr_clear(tmp7);
}
\end{Verbatim}
\end{minipage}\end{center}
\noindent Example 2: 
\begin{center}\begin{minipage}{15cm}\begin{Verbatim}[frame=single]
> bashexecute("gcc -fPIC -Wall -c libraryconstantexample.c -I$HOME/.local/includ
e");
> bashexecute("gcc -shared -o libraryconstantexample libraryconstantexample.o -l
gmp -lmpfr");
> euler_gamma = libraryconstant("./libraryconstantexample");
> implementconstant(euler_gamma^(1/3));
void
mpfr_const_something (mpfr_ptr y, mp_prec_t prec)
{
  /* Declarations */
  mpfr_t tmp1;

  /* Initializations */
  mpfr_init2 (tmp1, prec+1);
  mpfr_init2 (y, prec+2);

  /* Core */
  euler_gamma (tmp1, prec+1);
  mpfr_set_prec (y, prec+2);
  mpfr_root (y, tmp1, 3, MPFR_RNDN);

  /* Cleaning stuff */
  mpfr_clear(tmp1);
}
\end{Verbatim}
\end{minipage}\end{center}
See also: \textbf{implementpoly} (\ref{labimplementpoly}), \textbf{libraryconstant} (\ref{lablibraryconstant}), \textbf{library} (\ref{lablibrary})
